# added/edited
import os

import numpy as np
import openai
from dotenv import load_dotenv
from matplotlib import pyplot as plt
from openai import OpenAI
from scipy.spatial import distance  # type: ignore
from sklearn.manifold import TSNE  # type: ignore

load_dotenv()
openai.api_key = os.environ["OPENAI_API_KEY"]

# Create an OpenAI client and set your API key
client = OpenAI()


# Embed the search text
search_text = "soap"
search_embedding = create_embeddings(search_text)[0]

distances = []
for product in products:
    # Compute the cosine distance for each product description
    dist = distance.cosine(search_embedding, product["embedding"])
    distances.append(dist)

# Find and print the most similar product short_description
min_dist_ind = np.argmin(distances)
print(products[min_dist_ind]["short_description"])
